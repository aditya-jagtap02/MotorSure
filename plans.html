<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Insurance Plans</title>
    <link href="plans.css" rel="stylesheet">
    <script>
      function createOrder(planType, amount) {
        // Show dummy payment modal
        const modal = document.createElement('div');
        modal.className = 'payment-modal';
        modal.innerHTML = `
          <div class="payment-content">
            <h3>Dummy Payment Gateway</h3>
            <p>Plan: ${planType}</p>
            <p>Amount: ₹${amount}</p>
            <div class="dummy-card">
              <input type="text" placeholder="Card Number" maxlength="16" pattern="[0-9]{16}">
              <div class="card-details">
                <input type="text" placeholder="MM/YY" maxlength="5" pattern="[0-9]{2}/[0-9]{2}">
                <input type="text" placeholder="CVV" maxlength="4" pattern="[0-9]{3,4}">
              </div>
            </div>
            <div class="payment-buttons">
              <button onclick="processPayment('${planType}', ${amount})" class="btn">Pay Now</button>
              <button onclick="closeModal()" class="btn btn-cancel">Cancel</button>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }

      function processPayment(planType, amount) {
        // Simulate payment processing
        const modal = document.querySelector('.payment-modal');
        modal.innerHTML = `
          <div class="payment-content">
            <h3>Processing Payment...</h3>
            <div class="loading-spinner"></div>
          </div>
        `;

        // Simulate API call delay
        setTimeout(() => {
          fetch('verify_payment.php', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              planType: planType,
              amount: amount,
              payment_id: 'dummy_' + Date.now(),
              status: 'success'
            })
          })
          .then(response => response.json())
          .then(data => {
            if(data.success) {
              alert('Payment successful! Your insurance plan has been activated.');
              window.location.href = 'dashboard.php';
            } else {
              alert('Payment failed. Please try again.');
              closeModal();
            }
          })
          .catch(error => {
            console.error('Error:', error);
            alert('Payment failed. Please try again.');
            closeModal();
          });
        }, 2000);
      }

      function closeModal() {
        const modal = document.querySelector('.payment-modal');
        if (modal) {
          modal.remove();
        }
      }
    </script>
    <style>
      .payment-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .payment-content {
        background: white;
        padding: 20px;
        border-radius: 8px;
        width: 90%;
        max-width: 400px;
      }

      .dummy-card {
        margin: 20px 0;
      }

      .dummy-card input {
        width: 100%;
        padding: 10px;
        margin: 5px 0;
        border: 1px solid #ddd;
        border-radius: 4px;
      }

      .card-details {
        display: flex;
        gap: 10px;
      }

      .card-details input {
        width: 50%;
      }

      .payment-buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
      }

      .btn-cancel {
        background: #dc3545;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #007bff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 20px auto;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Insurance Plans</h1>

      <div class="tier">
        <h2>Diamond Tier</h2>
        <div class="plan">
          <p>New Parts Coverage</p>
          <p>Accident Forgiveness</p>
          <p>Decreasing Deductible</p>
          <p>Full Glass Coverage (No deductible)</p>
          <p class="price">Starting From ₹2499/Month</p>
          <button onclick="createOrder('Diamond', 2499)" class="btn">Buy Plan</button>
        </div>
      </div>

      <div class="tier">
        <h2>Platinum Tier</h2>
        <div class="plan">
          <p>Uninsured/Underinsured Motorist Coverage</p>
          <p>Roadside Assistance</p>
          <p>Rental Car Reimbursement</p>
          <p>Gap Insurance (If you have a loan)</p>
          <p class="price">Starting From ₹1999/Month</p>
          <button onclick="createOrder('Platinum', 1999)" class="btn">Buy Plan</button>
        </div>
      </div>

      <div class="tier">
        <h2>Gold Tier</h2>
        <div class="plan">
          <p>Liability Coverage</p>
          <p>Collision Coverage</p>
          <p>Comprehensive Coverage</p>
          <p>Personal Injury Protection</p>
          <p class="price">Starting From ₹1499/Month</p>
          <button onclick="createOrder('Gold', 1499)" class="btn">Buy Plan</button>
        </div>
      </div>
    </div>
  </body>
</html>